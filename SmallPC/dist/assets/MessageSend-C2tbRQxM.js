import{_ as e}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as t,h as a,d as s,i as l,c as i,a as o,e as n,f as r,w as h,j as g,o as d,g as m}from"./index-Snwcd9S9.js";const c={class:"audit"},p={class:"message"},u=["src"],x={class:"fy"};const C=e({data:()=>({nullLogoPng:"/assets/logo-BaXDuV-1.png",loading:!1,total:0,search:{pageCount:1,pageSize:10},msg:{msgTheme:"不咕嘟",msgText:""},tableList:[]}),created(){this.toSearch()},methods:{toSearch(){this.loading=!0,this.$apis.message.search(this.search).then((e=>{200==e.code?(this.tableList=e.data.records,this.total=e.data.total):(this.tableList=[],this.total=0),this.loading=!1}))},send(){this.msg.msgTheme?this.msg.msgText?(this.loading=!0,this.$apis.message.send(this.msg).then((e=>{200==e.code?(t({type:"success",message:"发送成功！"}),this.msg={msgTheme:"",msgText:""},this.toSearch(this.activeButton),this.loading=!1):t({type:"error",message:"发送失败！"})}))):t({type:"error",message:"请输入消息内容"}):t({type:"error",message:"请输入消息主题"})},handleDelete(e){this.loading=!0,a.confirm("将不再显示给用户","确定删除此官方通知？",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{this.$apis.message.deleteMsg({id:e}).then((e=>{200==e.code?(t({type:"success",message:"删除成功！"}),this.toSearch(this.activeButton)):t({type:"error",message:"删除失败！"}),this.loading=!1}))}))},handleSizeChange(e){this.search.pageSize=e,this.toSearch(this.activeButton)},handleCurrentChange(e){this.search.pageCount=e,this.toSearch(this.activeButton)}}},[["render",function(e,t,a,C,f,b){const y=s("el-input"),z=s("el-button"),T=s("el-table-column"),w=s("el-table"),S=s("el-pagination"),v=l("loading");return d(),i("div",c,[t[5]||(t[5]=o("h3",{style:{"font-weight":"bold"}},"官方消息发布",-1)),o("div",p,[n(y,{class:"item",modelValue:f.msg.msgTheme,"onUpdate:modelValue":t[0]||(t[0]=e=>f.msg.msgTheme=e),placeholder:"请输入消息主题",clearable:""},null,8,["modelValue"]),n(y,{modelValue:f.msg.msgText,"onUpdate:modelValue":t[1]||(t[1]=e=>f.msg.msgText=e),maxlength:"1000",placeholder:"请输入消息内容","show-word-limit":"",type:"textarea",autosize:{minRows:8,maxRows:8}},null,8,["modelValue"]),n(z,{style:{width:"100px",margin:"0 auto"},type:"primary",plain:"",onClick:t[2]||(t[2]=e=>b.send())},{default:r((()=>t[3]||(t[3]=[m("发布")]))),_:1})]),h((d(),g(w,{data:f.tableList,border:"",style:{width:"100%"},height:"480","max-height":"480","empty-text":"暂无数据",size:"small"},{default:r((()=>[n(T,{fixed:"",prop:"userHeadUrl",label:"头像",width:"60",align:"center"},{default:r((e=>[o("img",{class:"headUrl",src:e.row.userHeadUrl?e.row.userHeadUrl:f.nullLogoPng},null,8,u)])),_:1}),n(T,{prop:"msgTheme",label:"消息主题",width:"400",align:"center"}),n(T,{prop:"msgText",label:"消息内容",align:"center"}),n(T,{prop:"createTime",label:"发布时间",width:"200",align:"center"}),n(T,{fixed:"right",label:"操作",align:"center"},{default:r((e=>[n(z,{size:"small",type:"danger",onClick:t=>b.handleDelete(e.row.id)},{default:r((()=>t[4]||(t[4]=[m(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[v,f.loading]]),o("div",x,[n(S,{size:"small",onSizeChange:b.handleSizeChange,onCurrentChange:b.handleCurrentChange,"current-page":f.search.pageCount,"page-size":f.search.pageSize,"page-sizes":[10,20,30,50],background:"",layout:"total, sizes, prev, pager, next, jumper",total:f.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])}],["__scopeId","data-v-dac397af"]]);export{C as default};
