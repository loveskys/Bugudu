import{n as e}from"./nullhead-BfHF6COK.js";import{_ as t}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as a,h as i,d as l,i as s,c as o,a as c,e as n,f as r,w as d,j as h,o as p,g,n as u,t as y,k as m,F as v,m as w}from"./index-Snwcd9S9.js";const f={class:"audit"},k={class:"search"},C=["src"],b={key:0,class:"authopt-no"},D={key:1},_={style:{display:"flex","justify-content":"center",gap:"10px"}},x={key:0,style:{color:"#05a902"}},z={key:0,style:{color:"#d9a746"}},B={key:1,style:{color:"red"}},S={class:"fy"},U={class:"activityDetailDialog"},T={class:"dialog-left"},V={class:"dialog-left-intro"},I={style:{"font-weight":"bold","margin-left":"8px"}},A={class:"dialog-right"},P={key:0},j=["src"],H={key:1},N=["src"],$={key:0},L={key:1},R={key:2};const E=t({data:()=>({nullheadPng:e,loading:!1,activeButton:0,total:0,search:{pageCount:1,pageSize:10,theme:"",tag:0,wxCheck:0},tableList:[],activityDetail:{},activityDetailDialogVisible:!1}),created(){this.toSearch(0,0)},methods:{reset(){this.search={pageCount:1,pageSize:10,theme:"",tag:0,wxCheck:0},this.loading=!1,this.activeButton=0},toSearch(e,t){this.loading=!0,this.activeButton=e,this.search.tag=e&&"0"!=e?e:"",this.search.wxCheck=t,this.$apis.activity.search(this.search).then((e=>{200==e.code?(this.tableList=e.data.records,this.total=e.data.total):(this.tableList=[],this.total=0),this.loading=!1}))},openActivityDialog(e){this.$apis.activity.pc_detail({id:e}).then((e=>{200==e.code?(this.activityDetail=e.data,this.activityDetailDialogVisible=!0):a({type:"error",message:"详情查询失败！"})}))},handleDelete(e){this.loading=!0,i.confirm("将不再显示给用户","确定下架该活动？",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{this.$apis.activity.deleteActivity({id:e}).then((e=>{200===e.code?(a({type:"success",message:"操作成功！"}),this.toSearch(this.activeButton)):a({type:"error",message:"操作失败！"}),this.loading=!1})).catch((e=>{a({type:"error",message:"请求出错："+e.message}),this.loading=!1}))})).catch((()=>{this.loading=!1}))},handleRecommend(e){this.loading=!0,i.confirm("将显示or隐藏在首页推荐","确定操作？",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{this.$apis.activity.recommendActivity({id:e}).then((e=>{200===e.code?(a({type:"success",message:"操作成功！"}),this.toSearch(this.activeButton)):a({type:"error",message:"操作失败！"}),this.loading=!1})).catch((e=>{a({type:"error",message:"请求出错："+e.message}),this.loading=!1}))})).catch((()=>{this.loading=!1}))},handleCarousel(e,t){this.loading=!0,i.confirm("确定修改轮播图状态吗？","操作确认",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{this.$apis.activity.setCarousel({value:e,id:t}).then((e=>{200===e.code?(a({type:"success",message:"轮播图状态修改成功！"}),this.toSearch(this.activeButton)):a({type:"error",message:"操作失败！"}),this.loading=!1})).catch((e=>{a({type:"error",message:"请求出错："+e.message}),this.loading=!1}))})).catch((()=>{this.loading=!1}))},handleSizeChange(e){this.search.pageSize=e,this.toSearch(this.activeButton)},handleCurrentChange(e){this.search.pageCount=e,this.toSearch(this.activeButton)}}},[["render",function(e,t,a,i,E,F){const q=l("el-input"),G=l("el-button"),J=l("el-button-group"),K=l("el-table-column"),M=l("el-image"),O=l("el-table"),Q=l("el-pagination"),W=l("el-dialog"),X=s("loading");return p(),o("div",f,[t[27]||(t[27]=c("h3",{style:{"font-weight":"bold"}},"活动管理",-1)),c("div",k,[n(q,{class:"item",modelValue:E.search.activityTheme,"onUpdate:modelValue":t[0]||(t[0]=e=>E.search.activityTheme=e)},{prepend:r((()=>t[8]||(t[8]=[g("活动名称")]))),_:1},8,["modelValue"]),n(J,{class:"btn1"},{default:r((()=>[n(G,{type:"info",plain:"",onClick:F.reset},{default:r((()=>t[9]||(t[9]=[g("重置")]))),_:1},8,["onClick"]),n(G,{type:"primary",plain:"",onClick:t[1]||(t[1]=e=>F.toSearch())},{default:r((()=>t[10]||(t[10]=[g("搜索")]))),_:1})])),_:1}),n(J,{class:"btn2"},{default:r((()=>[n(G,{size:"small",class:u({active:0===E.activeButton}),type:"info",plain:"",onClick:t[2]||(t[2]=e=>F.toSearch(0,0))},{default:r((()=>t[11]||(t[11]=[g("全部")]))),_:1},8,["class"]),n(G,{size:"small",class:u({active:1===E.activeButton}),type:"info",plain:"",onClick:t[3]||(t[3]=e=>F.toSearch(1,0))},{default:r((()=>t[12]||(t[12]=[g("正在进行")]))),_:1},8,["class"]),n(G,{size:"small",class:u({active:2===E.activeButton}),type:"info",plain:"",onClick:t[4]||(t[4]=e=>F.toSearch(2,0))},{default:r((()=>t[13]||(t[13]=[g("已过期")]))),_:1},8,["class"]),n(G,{size:"small",class:u({active:3===E.activeButton}),type:"info",plain:"",onClick:t[5]||(t[5]=e=>F.toSearch(3,0))},{default:r((()=>t[14]||(t[14]=[g("已下架")]))),_:1},8,["class"]),n(G,{size:"small",class:u({active:4===E.activeButton}),type:"info",plain:"",onClick:t[6]||(t[6]=e=>F.toSearch(0,3))},{default:r((()=>t[15]||(t[15]=[g("违规")]))),_:1},8,["class"])])),_:1})]),d((p(),h(O,{data:E.tableList,border:"",style:{width:"100%"},height:"720","max-height":"720","empty-text":"暂无数据",size:"small"},{default:r((()=>[n(K,{fixed:"",prop:"headUrl",label:"头像",width:"70",align:"center"},{default:r((e=>[c("img",{class:"headUrl",src:e.row.headUrl?e.row.headUrl:E.nullheadPng},null,8,C)])),_:1}),n(K,{prop:"id",label:"活动ID",width:"70",align:"center"}),n(K,{prop:"theme",label:"活动主题",align:"center"}),n(K,{prop:"locationName",label:"活动地址",align:"center"},{default:r((e=>[g(y(e.row.locationName+": "+e.row.locationAddress),1)])),_:1}),n(K,{prop:"image",label:"活动图片",width:"130",align:"center"},{default:r((e=>[n(M,{class:"image","preview-teleported":"","hide-on-click-modal":"",src:e.row.image,"preview-src-list":[e.row.image],"initial-index":1,fit:"cover"},null,8,["src","preview-src-list"])])),_:1}),n(K,{prop:"nickName",label:"发布人昵称",width:"100",align:"center"}),n(K,{prop:"contactType",label:"发布人联系方式",width:"130",align:"center"},{default:r((e=>[g(y(e.row.contactType+": "+e.row.contact),1)])),_:1}),n(K,{prop:"createTime",label:"提交发布时间",width:"150",align:"center"}),n(K,{label:"状态",align:"center",width:"140"},{default:r((e=>[3==e.row.wxImgCheck?(p(),o("div",b,y(e.row.auditCont)+" 自动下架 ",1)):(p(),o("view",D,[c("view",_,[0!=E.activeButton&&1!=E.activeButton||"0"!=e.row.isPast||"0"!=e.row.isDelete?m("",!0):(p(),o("div",x,y("1"==e.row.recommend?"（推荐）":"")+"活动进行中",1))]),0!=E.activeButton&&2!=E.activeButton||"1"!=e.row.isPast?m("",!0):(p(),o("div",z," 活动已过期 ")),"1"==e.row.isDelete?(p(),o("div",B," 活动已被下架 ")):m("",!0)]))])),_:1}),n(K,{fixed:"right",label:"查看详情",align:"center"},{default:r((e=>["3"!=e.row.wxImgCheck&&1==E.activeButton&&"0"==e.row.isDelete?(p(),h(J,{key:0},{default:r((()=>["1"==e.row.recommend?(p(),h(G,{key:0,size:"small",type:"info",onClick:t=>F.handleRecommend(e.row.id)},{default:r((()=>t[16]||(t[16]=[g("取消推荐")]))),_:2},1032,["onClick"])):(p(),h(G,{key:1,size:"small",type:"primary",onClick:t=>F.handleRecommend(e.row.id)},{default:r((()=>t[17]||(t[17]=[g("设置推荐")]))),_:2},1032,["onClick"])),n(G,{size:"small",type:"danger",onClick:t=>F.handleDelete(e.row.id)},{default:r((()=>t[18]||(t[18]=[g("下架活动")]))),_:2},1032,["onClick"]),"1"==e.row.swiper?(p(),h(G,{key:2,size:"small",type:"info",onClick:t=>F.handleCarousel("0",e.row.id)},{default:r((()=>t[19]||(t[19]=[g("取消轮播图")]))),_:2},1032,["onClick"])):(p(),h(G,{key:3,size:"small",type:"primary",onClick:t=>F.handleCarousel("0",e.row.id)},{default:r((()=>t[20]||(t[20]=[g("设置轮播图")]))),_:2},1032,["onClick"]))])),_:2},1024)):m("",!0),n(G,{size:"small",onClick:t=>F.openActivityDialog(e.row.id)},{default:r((()=>t[21]||(t[21]=[g(" 查看详情 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[X,E.loading]]),c("div",S,[n(Q,{size:"small",onSizeChange:F.handleSizeChange,onCurrentChange:F.handleCurrentChange,"current-page":E.search.pageCount,"page-size":E.search.pageSize,"page-sizes":[10,20,30,50],background:"",layout:"total, sizes, prev, pager, next, jumper",total:E.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),n(W,{modelValue:E.activityDetailDialogVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>E.activityDetailDialogVisible=e),title:"活动详情",width:"60%"},{default:r((()=>[c("div",U,[c("div",T,[c("view",null,y("活动主题："+E.activityDetail.theme),1),n(M,{class:"dialog-left-image","preview-teleported":"","hide-on-click-modal":"",src:E.activityDetail.image,"preview-src-list":[E.activityDetail.image],"initial-index":1,fit:"cover"},null,8,["src","preview-src-list"]),t[22]||(t[22]=c("view",{style:{"margin-top":"6px",color:"#666"}},"活动描述：",-1)),c("view",V,y(E.activityDetail.intro),1),t[23]||(t[23]=c("view",{style:{"margin-top":"6px",color:"#666"}},"活动时间：",-1)),c("view",I,y(E.activityDetail.activityStart+" ---- "+E.activityDetail.activityEnd),1),t[24]||(t[24]=c("view",{style:{"margin-top":"6px",color:"#666"}},"活动要求：",-1)),c("view",null,[(p(!0),o(v,null,w(E.activityDetail.conditArray,((e,t)=>(p(),o("view",{class:"dialog-left-conditArray-item",key:t},y(e),1)))),128))]),t[25]||(t[25]=c("view",{style:{"margin-top":"6px",color:"#666"}},"活动地点：",-1)),c("view",null,"【"+y(E.activityDetail.location.locationName+"】 "+E.activityDetail.location.locationAddress+" "+(E.activityDetail.location.address?E.activityDetail.location.address:"")),1)]),c("div",A,[g(y("报名人数："+E.activityDetail.applyPeople.length+" 人")+" ",1),n(O,{data:E.activityDetail.applyPeople,border:"",size:"small",style:{width:"100%"},"max-height":"55vh"},{default:r((()=>[n(K,{fixed:"",prop:"userHeadUrl",label:"头像",width:"70",align:"center"},{default:r((e=>["1"==e.row.isIssue?(p(),o("div",P,[c("img",{class:"headUrl-Issue",src:e.row.userHeadUrl?e.row.userHeadUrl:E.nullheadPng},null,8,j),t[26]||(t[26]=c("div",{class:"headUrl-Issue-tag"},"发布人",-1))])):(p(),o("div",H,[c("img",{class:"headUrl",src:e.row.userHeadUrl?e.row.userHeadUrl:E.nullheadPng},null,8,N)]))])),_:1}),n(K,{property:"userId",label:"用户ID",width:"70",align:"center"}),n(K,{property:"sex",label:"性别",width:"70",align:"center"},{default:r((e=>[1==e.row.sex?(p(),o("div",$,"男")):2==e.row.sex?(p(),o("div",L,"女")):(p(),o("div",R,"未知"))])),_:1}),n(K,{property:"grade",label:"年级",width:"70",align:"center"}),n(K,{property:"nickName",label:"称呼",width:"150",align:"center"}),n(K,{property:"contact",label:"联系方式",align:"center",width:"150"})])),_:1},8,["data"])])])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-3ac30c38"]]);export{E as default};
